# Initial Commands --------------------------------------------------------
rm(list = ls(all.names = TRUE)) # clear objects
gc() # free up memory
set.seed(1234)
# Downloads required libraries --------------------------------------------
renv::restore()
# Libraries ---------------------------------------------------------------
library("tidyverse")    # to handle data
library("estimatr")
library("modelsummary") # to create tables
library('geobr')        # to create maps
library('skimr')        # to create sumstats
library('rdrobust')     # to run rdd
library('patchwork')    # to create figures with plots together
# Setting -----------------------------------------------------------------
work_dir                       = "C:/Users/wb633398/Documents/GitHub/Personal/rep_package_when_science_strikes_back"
output_dir                     = paste0(work_dir,"/outputs")
data_dir                       = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/output"
mayors_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/3_create_education_data/output/data"
baseline_data_dir              = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/5_create_baseline_data/output/data"
covid_data_dir                 = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/4_create_covid_data/output/data"
tenure_data_dir                = "C:/Users/gabri/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/input"
# Running scripts ---------------------------------------------------------
source("/code/01_create_dataset.R")
source("code/01_create_dataset.R")
# Description -------------------------------------------------------------
## This code reproduces all tables and figures from the paper
# Initial Commands --------------------------------------------------------
rm(list = ls(all.names = TRUE)) # clear objects
gc() # free up memory
set.seed(1234)
# Downloads required libraries --------------------------------------------
renv::restore()
# Libraries ---------------------------------------------------------------
library("tidyverse")    # to handle data
library("estimatr")
library("modelsummary") # to create tables
library('geobr')        # to create maps
library('skimr')        # to create sumstats
library('rdrobust')     # to run rdd
library('patchwork')    # to create figures with plots together
# Setting -----------------------------------------------------------------
work_dir                       = "C:/Users/wb633398/Documents/GitHub/Personal/rep_package_when_science_strikes_back"
output_dir                     = paste0(work_dir,"/outputs")
data_dir                       = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/output"
mayors_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/3_create_education_data/output/data"
baseline_data_dir              = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/5_create_baseline_data/output/data"
covid_data_dir                 = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/4_create_covid_data/output/data"
tenure_data_dir                = "C:/Users/gabri/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/input"
# Running scripts ---------------------------------------------------------
source("code/01_create_dataset.R")
# Description -------------------------------------------------------------
## This code reproduces all tables and figures from the paper
# Initial Commands --------------------------------------------------------
rm(list = ls(all.names = TRUE)) # clear objects
gc() # free up memory
set.seed(1234)
# Downloads required libraries --------------------------------------------
renv::restore()
# Libraries ---------------------------------------------------------------
library("tidyverse")    # to handle data
library("estimatr")
library("modelsummary") # to create tables
library('geobr')        # to create maps
library('skimr')        # to create sumstats
library('rdrobust')     # to run rdd
library('patchwork')    # to create figures with plots together
# Setting -----------------------------------------------------------------
work_dir                       = "C:/Users/wb633398/Documents/GitHub/Personal/rep_package_when_science_strikes_back"
output_dir                     = paste0(work_dir,"/outputs")
data_dir                       = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/output"
mayors_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/3_create_education_data/output/data"
baseline_data_dir              = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/5_create_baseline_data/output/data"
covid_data_dir                 = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/4_create_covid_data/output/data"
tenure_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/input"
# Running scripts ---------------------------------------------------------
source("code/01_create_dataset.R")
# Description -------------------------------------------------------------
## This code reproduces all tables and figures from the paper
# Initial Commands --------------------------------------------------------
rm(list = ls(all.names = TRUE)) # clear objects
gc() # free up memory
set.seed(1234)
# Downloads required libraries --------------------------------------------
renv::restore()
# Libraries ---------------------------------------------------------------
library("tidyverse")    # to handle data
library("estimatr")
library("modelsummary") # to create tables
library('geobr')        # to create maps
library('skimr')        # to create sumstats
library('rdrobust')     # to run rdd
library('patchwork')    # to create figures with plots together
# Setting -----------------------------------------------------------------
work_dir                       = "C:/Users/wb633398/Documents/GitHub/Personal/rep_package_when_science_strikes_back"
output_dir                     = paste0(work_dir,"/outputs")
data_dir                       = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/output"
mayors_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/3_create_education_data/output/data"
baseline_data_dir              = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/5_create_baseline_data/output/data"
covid_data_dir                 = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/4_create_covid_data/output/data"
tenure_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/input"
# Running scripts ---------------------------------------------------------
source("code/01_create_dataset.R")
# Description -------------------------------------------------------------
## This code reproduces all tables and figures from the paper
# Initial Commands --------------------------------------------------------
rm(list = ls(all.names = TRUE)) # clear objects
gc() # free up memory
set.seed(1234)
# Downloads required libraries --------------------------------------------
renv::restore()
# Libraries ---------------------------------------------------------------
library("tidyverse")    # to handle data
library("estimatr")
library("modelsummary") # to create tables
library('geobr')        # to create maps
library('skimr')        # to create sumstats
library('rdrobust')     # to run rdd
library('patchwork')    # to create figures with plots together
# Setting -----------------------------------------------------------------
work_dir                       = "C:/Users/wb633398/Documents/GitHub/Personal/rep_package_when_science_strikes_back"
output_dir                     = paste0(work_dir,"/outputs")
data_dir                       = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/output"
mayors_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/3_create_education_data/output/data"
baseline_data_dir              = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/5_create_baseline_data/output/data"
covid_data_dir                 = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/4_create_covid_data/output/data"
tenure_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/input"
# Parameters --------------------------------------------------------------
data = "rdd_data_main_broad_definition" # Machado's STEM classification
# Running scripts ---------------------------------------------------------
source("code/01_create_dataset.R")
# Description - This code reproduces all tables and figures from the paper
# TO DO
## Run sum stats
# Initial Commands --------------------------------------------------------
rm(list = ls(all.names = TRUE)) # clear objects
gc() # free up memory
set.seed(1234)
# Downloads required libraries --------------------------------------------
renv::restore()
# Libraries ---------------------------------------------------------------
library("tidyverse")    # to handle data
library("estimatr")
library("modelsummary") # to create tables
library('geobr')        # to create maps
library('skimr')        # to create sumstats
library('rdrobust')     # to run rdd
library('patchwork')    # to create figures with plots together
# Setting -----------------------------------------------------------------
output_dir                     = paste0(getwd(),"/outputs")
data_dir                       = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/output"
mayors_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/3_create_education_data/output/data"
baseline_data_dir              = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/5_create_baseline_data/output/data"
covid_data_dir                 = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/4_create_covid_data/output/data"
tenure_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/input"
# Parameters --------------------------------------------------------------
data = "rdd_data_college_mayors_only_" # Machado's STEM classification, both 2016 and 2020 cohorts and only considering municipalities where de NON-STEM mayor had college education
# Running scripts ---------------------------------------------------------
source("code/01_create_dataset.R")
df <- readRDS(paste(data_dir, data, sep = ""))
df <- readRDS(paste(data_dir, '/', data, sep = ""))
# Description - This code reproduces all tables and figures from the paper
# TO DO
## Run sum stats
# Initial Commands --------------------------------------------------------
rm(list = ls(all.names = TRUE)) # clear objects
gc() # free up memory
set.seed(1234)
# Downloads required libraries --------------------------------------------
renv::restore()
# Libraries ---------------------------------------------------------------
library("tidyverse")    # to handle data
library("estimatr")
library("modelsummary") # to create tables
library('geobr')        # to create maps
library('skimr')        # to create sumstats
library('rdrobust')     # to run rdd
library('patchwork')    # to create figures with plots together
# Setting -----------------------------------------------------------------
output_dir                     = paste0(getwd(),"/outputs")
data_dir                       = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/output"
mayors_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/3_create_education_data/output/data"
baseline_data_dir              = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/5_create_baseline_data/output/data"
covid_data_dir                 = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/4_create_covid_data/output/data"
tenure_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/input"
# Parameters --------------------------------------------------------------
data = "rdd_data_college_mayors_only_" # Machado's STEM classification, both 2016 and 2020 cohorts and only considering municipalities where de NON-STEM mayor had college education
# Running scripts ---------------------------------------------------------
source("code/01_create_dataset.R")
# Description - This code reproduces all tables and figures from the paper
# TO DO
## Run sum stats
# Initial Commands --------------------------------------------------------
rm(list = ls(all.names = TRUE)) # clear objects
gc() # free up memory
set.seed(1234)
# Downloads required libraries --------------------------------------------
renv::restore()
# Libraries ---------------------------------------------------------------
library("tidyverse")    # to handle data
library("estimatr")
library("modelsummary") # to create tables
library('geobr')        # to create maps
library('skimr')        # to create sumstats
library('rdrobust')     # to run rdd
library('patchwork')    # to create figures with plots together
# Setting -----------------------------------------------------------------
output_dir                     = paste0(getwd(),"/outputs")
data_dir                       = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/output"
mayors_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/3_create_education_data/output/data"
baseline_data_dir              = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/5_create_baseline_data/output/data"
covid_data_dir                 = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/4_create_covid_data/output/data"
tenure_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/input"
# Parameters --------------------------------------------------------------
data = "rdd_data_college_mayors_only_broad_definition" # Machado's STEM classification, both 2016 and 2020 cohorts and only considering municipalities where de NON-STEM mayor had college education
# Running scripts ---------------------------------------------------------
source("code/01_create_dataset.R")
df <- readRDS(paste(data_dir, '/', data, sep = ""))
data = "/rdd_data_college_mayors_only_broad_definition.R" # Machado's STEM classification, both 2016 and 2020 cohorts and only considering municipalities where de NON-STEM mayor had college education
df <- readRDS(paste(data_dir, data, sep = ""))
data = "rdd_data_college_mayors_only_broad_definition.R" # Machado's STEM classification, both 2016 and 2020 cohorts and only considering municipalities where de NON-STEM mayor had college education
df <- readRDS(paste("/data/final/", data, sep = ""))
output_dir                     = paste0(getwd(),"/outputs")
data_dir                       = paste0(getwd(),"/data")
df <- readRDS(paste(data_dir, "/final/", data, sep = ""))
data = "rdd_data_college_mayors_only_broad_definition.Rds" # Machado's STEM classification, both 2016 and 2020 cohorts and only considering municipalities where de NON-STEM mayor had college education
df <- readRDS(paste(data_dir, "/final/", data, sep = ""))
# Description - This code reproduces all tables and figures from the paper
# TO DO
## Run sum stats
# Initial Commands --------------------------------------------------------
rm(list = ls(all.names = TRUE)) # clear objects
gc() # free up memory
set.seed(1234)
# Downloads required libraries --------------------------------------------
renv::restore()
# Libraries ---------------------------------------------------------------
library("tidyverse")    # to handle data
library("estimatr")
library("modelsummary") # to create tables
library('geobr')        # to create maps
library('skimr')        # to create sumstats
library('rdrobust')     # to run rdd
library('patchwork')    # to create figures with plots together
# Setting -----------------------------------------------------------------
output_dir                     = paste0(getwd(),"/outputs")
data_dir                       = paste0(getwd(),"/data")
mayors_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/3_create_education_data/output/data"
baseline_data_dir              = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/5_create_baseline_data/output/data"
covid_data_dir                 = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/4_create_covid_data/output/data"
tenure_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/input"
# Parameters --------------------------------------------------------------
data = "rdd_data_college_mayors_only_broad_definition.Rds" # Machado's STEM classification, both 2016 and 2020 cohorts and only considering municipalities where de NON-STEM mayor had college education
# Running scripts ---------------------------------------------------------
source("code/01_create_dataset.R")
df <- readRDS(paste(data_dir, "/final/", data, sep = ""))
df <- df %>% # Removing NPI data from municipalities in 2020 chort (since this data only regards mayors elected in 2016)
mutate(
total_nfi = ifelse(coorte == 2020, NA, total_nfi),
barreiras_sanitarias = ifelse(coorte == 2020, NA, barreiras_sanitarias),
mascaras = ifelse(coorte == 2020, NA, mascaras),
restricao_atv_nao_essenciais = ifelse(coorte == 2020, NA, restricao_atv_nao_essenciais),
restricao_circulacao = ifelse(coorte == 2020, NA, restricao_circulacao),
restricao_transporte_publico = ifelse(coorte == 2020, NA, restricao_transporte_publico)
)
dat <- df[ c("stem_background", # keeping only relevant variables
"tenure",
"X",
"mulher",
"idade",
"instrucao",
"reeleito",
"ideology_party",
"populacao",
"densidade",
#"taxa_analfabetismo_18_mais",
#"indice_gini",
"idhm",
"renda_pc",
"per_populacao_urbana",
"per_populacao_homens",
"tx_med",
"pct_desp_recp_saude_mun",
"cob_esf",
"tx_leito_sus",
"ideology_municipality",
"Y_deaths_sivep",
"Y_hosp",
#"Y_cases",
"barreiras_sanitarias",
"mascaras",
"restricao_atv_nao_essenciais",
"restricao_circulacao",
"restricao_transporte_publico",
"total_nfi")]
dat <- dat %>%
summarise(
"Tenure in STEM job" = tenure,
"Female" = as.numeric(mulher),
"Age" = idade,
"Education" = instrucao,
"Incumbent when elected" = as.numeric(reeleito),
"Party ideology" = ideology_party,
"Deaths per 100k inhabitants" = Y_deaths_sivep,
"Hospitalizations per 100k inhabitants" = Y_hosp,
"Cordon sanitaire" = barreiras_sanitarias,
"Face covering required" = mascaras,
"Closure of non-essential activities" = restricao_atv_nao_essenciais,
"Gathering prohibition" = restricao_circulacao,
"Public transport restriction" = restricao_transporte_publico,
"Number of Non-Pharmaceutical Interventions" = total_nfi,
"Log of population in 2010" = log(populacao),
"Human Development Index" = idhm,
"Per capita income" = renda_pc,
"Population density" = densidade,
"Urban population rate" = per_populacao_urbana,
"Men population rate" = per_populacao_homens,
"Physicians per 1k inhabitants" = tx_med,
"Health municipal spending rate" = pct_desp_recp_saude_mun,
"Community health agency coverage rate" = cob_esf,
"Hospital beds per 100k population" = tx_leito_sus,
stem_background
)
tab <- datasummary(All(data.frame(dat)) ~ N  + Min + Mean + Max + SD, data = dat, fmt = 2)
tab
datasummary(All(data.frame(dat)) ~ N  + Min + Mean + Max + SD, data = dat, fmt = 2, output = paste0(output_dir, "/tables/table_sum_stats.tex"))
datasummary(All(data.frame(dat)) ~ N  + Min + Mean + Max + SD, data = dat, fmt = 2, output = paste0(output_dir, "/tables/table_sum_stats.md"))
source("C:/Users/wb633398/Documents/GitHub/Personal/rep_package_when_science_strikes_back/outputs/tables/table_sum_stats.md")
includeMarkdown("outputs/tables/table_sum_stats.md")
renv::install("htmltools")
htmltools::includeMarkdown("outputs/tables/table_sum_stats.md")
cat(readLines(("outputs/tables/table_sum_stats.md"), sep = "\n")
cat(readLines("outputs/tables/table_sum_stats.md"), sep = "\n")
#cat(readLines("outputs/tables/table_sum_stats.md"), sep = "\n")
knitr::asis_output(paste(texto, collapse = "\n"))
#cat(readLines("outputs/tables/table_sum_stats.md"), sep = "\n")
knitr::asis_output(paste("outputs/tables/table_sum_stats.md", collapse = "\n"))
#cat(readLines("outputs/tables/table_sum_stats.md"), sep = "\n")
knitr::asis_output(paste(getwd(),"outputs/tables/table_sum_stats.md", collapse = "\n"))
#cat(readLines("outputs/tables/table_sum_stats.md"), sep = "\n")
# Carrega o arquivo como texto
texto <- readLines("outputs/tables/table_sum_stats.md")
# Renderiza o conteúdo como Markdown
knitr::asis_output(paste(texto, collapse = "\n"))
library('knitr')
# Carrega o arquivo da tabela como texto
texto <- readLines("outputs/tables/table_sum_stats.md")
# Renderiza o conteúdo como Markdown
knitr::asis_output(paste(texto, collapse = "\n"), meta = ":Tabela Teste")
unique(readRDS(paste(data_dir, "/final/", data, sep = "")))
columns(readRDS(paste(data_dir, "/final/", data, sep = "")))
nrow(readRDS(paste(data_dir, "/final/", data, sep = "")))
# Carrega o arquivo da tabela como texto
texto <- readLines("outputs/tables/table_sum_stats.md")
# Renderiza o conteúdo como Markdown
knitr::asis_output(paste(texto, collapse = "\n"), meta = ":Tabela Teste")
data_dir                       = paste0(getwd(),"/data")
sumstats_data <- nrow(readRDS(paste(data_dir, "/final/", data, sep = "")))
nobs_sumstats <- nrow(readRDS(paste(data_dir, "/final/", data, sep = "")))
# Running all scripts that generate figures and tables
source("code/00_main_code.R")
# Running all scripts that generate figures and tables
source("code/00_main_code.R")
# TODOS
## Tirar o output desta celula
## Incluir titulo da tabela Sum Stats
## Incluir codigo inline
# Running all scripts that generate figures and tables
source("code/00_main_code.R")
cohorts_used   <- unique(dados_sumstats$cohort)
dados_sumstats <- readRDS(paste(data_dir, "/final/", data, sep = ""))
nobs_sumstats  <- nrow(dados_sumstats)
cohorts_used   <- unique(dados_sumstats$cohort)
View(dados_sumstats)
cohorts_used   <- unique(dados_sumstats$coorte)
cohorts_used
cohorts_used[1]
# Description - This code reproduces all tables and figures from the paper
# TO DO
## Run sum stats
# Initial Commands --------------------------------------------------------
rm(list = ls(all.names = TRUE)) # clear objects
gc() # free up memory
set.seed(1234)
# Downloads required libraries --------------------------------------------
renv::restore()
# Libraries ---------------------------------------------------------------
library("tidyverse")    # to handle data
library("estimatr")
library("modelsummary") # to create tables
library('geobr')        # to create maps
library('skimr')        # to create sumstats
library('rdrobust')     # to run rdd
library('patchwork')    # to create figures with plots together
library('knitr')
# Setting -----------------------------------------------------------------
output_dir                     = paste0(getwd(),"/outputs")
data_dir                       = paste0(getwd(),"/data")
mayors_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/3_create_education_data/output/data"
baseline_data_dir              = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/5_create_baseline_data/output/data"
covid_data_dir                 = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/4_create_covid_data/output/data"
tenure_data_dir                = "C:/Users/wb633398/OneDrive/Gabriel/Insper/Tese/Engenheiros/replication_code/rdd_when_science_strikes_back/6_create_rdd_dataset/input"
# Parameters --------------------------------------------------------------
data = "rdd_data_college_mayors_only_broad_definition.Rds" # Machado's STEM classification, both 2016 and 2020 cohorts and only considering municipalities where de NON-STEM mayor had college education
df <- readRDS(paste(data_dir, "/final/", data, sep = ""))
df <- df %>% # Removing NPI data from municipalities in 2020 chort (since this data only regards mayors elected in 2016)
mutate(
total_nfi = ifelse(coorte == 2020, NA, total_nfi),
barreiras_sanitarias = ifelse(coorte == 2020, NA, barreiras_sanitarias),
mascaras = ifelse(coorte == 2020, NA, mascaras),
restricao_atv_nao_essenciais = ifelse(coorte == 2020, NA, restricao_atv_nao_essenciais),
restricao_circulacao = ifelse(coorte == 2020, NA, restricao_circulacao),
restricao_transporte_publico = ifelse(coorte == 2020, NA, restricao_transporte_publico)
)
dat <- df[c(
"stem_background",
# keeping only relevant variables
"tenure",
"X",
"mulher",
"idade",
"instrucao",
"reeleito",
"ideology_party",
"populacao",
"densidade",
#"taxa_analfabetismo_18_mais",
#"indice_gini",
"idhm",
"renda_pc",
"per_populacao_urbana",
"per_populacao_homens",
"tx_med",
"pct_desp_recp_saude_mun",
"cob_esf",
"tx_leito_sus",
"ideology_municipality",
"Y_deaths_sivep",
"Y_hosp",
#"Y_cases",
"barreiras_sanitarias",
"mascaras",
"restricao_atv_nao_essenciais",
"restricao_circulacao",
"restricao_transporte_publico",
"total_nfi"
)]
dat <- dat %>%
summarise(
"Tenure in STEM job" = tenure,
"Female" = as.numeric(mulher),
"Age" = idade,
"Education" = instrucao,
"Incumbent when elected" = as.numeric(reeleito),
"Party ideology" = ideology_party,
"Deaths per 100k inhabitants" = Y_deaths_sivep,
"Hospitalizations per 100k inhabitants" = Y_hosp,
"Cordon sanitaire" = barreiras_sanitarias,
"Face covering required" = mascaras,
"Closure of non-essential activities" = restricao_atv_nao_essenciais,
"Gathering prohibition" = restricao_circulacao,
"Public transport restriction" = restricao_transporte_publico,
"Number of Non-Pharmaceutical Interventions" = total_nfi,
"Log of population in 2010" = log(populacao),
"Human Development Index" = idhm,
"Per capita income" = renda_pc,
"Population density" = densidade,
"Urban population rate" = per_populacao_urbana,
"Men population rate" = per_populacao_homens,
"Physicians per 1k inhabitants" = tx_med,
"Health municipal spending rate" = pct_desp_recp_saude_mun,
"Community health agency coverage rate" = cob_esf,
"Hospital beds per 100k population" = tx_leito_sus,
stem_background
)
tab <- datasummary(All(data.frame(dat)) ~ N  + Min + Mean + Max + SD,
data = dat,
fmt = 2)
tab
datasummary(
All(data.frame(dat)) ~ N  + Min + Mean + Max + SD,
data = dat,
fmt = 2,
output = paste0(output_dir, "/tables/table_sum_stats.md")
)
dat$stem_background <- ifelse(dat$stem_background == 1, "STEM", "Non-STEM")
datasummary_balance( ~ stem_background, dinm_statistic = "p.value", data = dat, fmt = 2)
datasummary_balance( ~ stem_background, dinm_statistic = "p.value", data = dat, fmt = 2, output = paste0(output_dir, "/tables/table_sum_stats_grouos.md"))
datasummary_balance( ~ stem_background, dinm_statistic = "p.value", data = dat, fmt = 2, output = paste0(output_dir, "/tables/table_sum_stats_groups.md"))
tbl-cap: "testando"
tbl-cap: "testando"
tbl-cap: "testando"
#| tbl-cap: "testando"
# Carrega o arquivo da tabela como texto
texto <- readLines("outputs/tables/table_sum_stats_groups.md")
# Renderiza o conteúdo como Markdown
knitr::asis_output(paste(texto, collapse = "\n"))
#| tbl-cap: "testando"
# Carrega o arquivo da tabela como texto
texto <- readLines("outputs/tables/table_sum_stats_groups.md")
# Renderiza o conteúdo como Markdown
knitr::asis_output(paste(texto, collapse = "\n"))
#| tbl-cap: "Summary Statistics per Group"
# Carrega o arquivo da tabela como texto
texto <- readLines("outputs/tables/table_sum_stats_groups.md")
# Renderiza o conteúdo como Markdown
knitr::asis_output(paste(texto, collapse = "\n"))
#| tbl-cap: "Summary Statistics per Group"
# Carrega o arquivo da tabela como texto
texto <- readLines("outputs/tables/table_sum_stats_groups.md")
# Renderiza o conteúdo como Markdown
knitr::asis_output(paste(texto, collapse = "\n"))
